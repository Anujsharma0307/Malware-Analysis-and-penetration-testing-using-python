#!/usr/bin/env python
import scapy.all as scapy

def scan(ip):
    arp_req = scapy.ARP(pdst=ip)
    broadcast = scapy.Ether(dst="ff:ff:ff:ff:ff:ff")
    arp_broadcast = broadcast/arp_req
    # SEND AND RECEIVE
    ans_list = scapy.srp(arp_broadcast, timeout=50, verbose=False)[0] #only need element 0 from the 2 elements,no need of unanswered list
    # print(ans_list.summary())
    client_list = []
    for element in ans_list:
        #print(element)
        #print(element[1].show())  #second part in the element list
        client_dict = {"ip": element[1].psrc, "mac": element[1].hwsrc}
        client_list.append(client_dict)
    return client_list
def print_list(result_list):
    print("IP\t\t\tMAC\n---------------------------------------")
    for client in result_list:
        print(client["ip"] + "\t\t" + client["mac"])
        # print(client)

address = input("IP IS ")
result = scan(address)
print_list(result)